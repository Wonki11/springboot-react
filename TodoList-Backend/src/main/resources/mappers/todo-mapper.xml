<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="todo.mapper.TodoMapper">
	<select id="idCheck">
		SELECT COUNT(*) FROM TODO_MEMBER WHERE ID = #{id}
	</select>
	
	<insert id="signup">
	INSERT INTO TODO_MEMBER
	VALUES(SEQ_TODO_MEMBER_NO.NEXTVAL, #{id} , #{pw}, #{name})
	</insert>
	
	<select id= "login" resultType="TodoMember">
		SELECT * FROM TODO_MEMBER
		WHERE ID = #{id} 
		AND PW = #{pw}
	</select>
	
	<!-- DB에 있는 TODO 테이블에서 해당 번호 할 일이 완료 됐는지 isDone으로 완료 여부 수정 -->
	<update id="update">
		UPDATE TODO 
		SET IS_DONE = #{isDone}
		WHERE TODO_NO = ${todoNo}
	</update>
	
	<delete id="delete">
		DELETE FROM TODO 
		WHERE TODO_NO = ${todoNo}
	</delete>
	
	<!--  할 일 추가하는 insert 
	insert 특정 값을 DB에 넣기 전에 해당하는 값을 미리 가져와서 확인
	
	useGeneratedKeys 		 = 자동으로 생성된 키를 사용하도록 설정
	selectKey order="BEFORE" = INSERT 문이 실행 되기 전에 select문을 실행하겠다 라는 설정
	resultType				 ="_int" = resultType="_int" 모두 int 타입으로 지정된다는 의미
	-->
	<insert id="insert" useGeneratedKeys="true">
		<selectKey order="BEFORE" keyProperty="todoNo" resultType="_int">
			SELECT SEQ_TODO_NO.NEXTVAL FROM DUAL 
		</selectKey>
		INSERT INTO TODO 
		VALUES(${todoNo}, #{title}, default, ${todoMemberNo})
	</insert>
</mapper>
